<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pemesanan Mobil & Dashboard</title>
  <style>
    /* === STYLE LOGIN & UMUM === */
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f7fa;
    }

    .login-page {
      /* Latar belakang hitam */
      background: #000000;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .container {
      background: #fff;
      border-radius: 15px;
      width: 350px;
      padding: 20px 30px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      text-align: center;
      position: relative;
    }

    .container img { width: 100px; margin-bottom: 15px; }

    h2 { margin: 0; color: #2c2c2c; font-size: 22px; margin-bottom: 20px; }

    input[type="email"], input[type="password"], input[type="text"], input[type="number"], select {
      width: 90%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    
    .form-tambah input[type="text"], .form-tambah input[type="number"], .form-tambah select {
        width: 100%; /* Override default width 90% in small form */
    }

    button {
      width: 95%;
      padding: 10px;
      background-color: #4c51bf;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover { background-color: #434190; }

    .links { margin-top: 15px; display: flex; justify-content: space-around; }
    .links a { color: #4c51bf; cursor: pointer; text-decoration: underline; }

    .modal { display: none; position: fixed; z-index: 30; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); }
    .modal-content {
      background: #fff; margin: 5% auto; padding: 20px; width: 420px; border-radius: 10px; text-align: left;
      position: relative; overflow-y: auto; max-height: 90vh;
    }
    .close { position: absolute; top: 8px; right: 10px; cursor: pointer; color: #555; font-weight: bold; font-size: 18px; }
    .close:hover { color: red; }

    .btn-secondary { background-color: #ccc; color: black; border: none; width: 45%; border-radius: 6px; padding: 8px; cursor: pointer; }
    .btn-primary { background-color: #4c51bf; color: white; border: none; width: 45%; border-radius: 6px; padding: 8px; cursor: pointer; }
    .btn-primary:hover { background-color: #434190; }

    /* === DASHBOARD === */
    .dashboard-page { display: none; background: #f5f7fa; min-height: 100vh; color: #333; }
    header {
      background: linear-gradient(90deg, #4a90e2, #007bff);
      color: white; padding: 20px; text-align: center; border-bottom-left-radius: 20px; border-bottom-right-radius: 20px;
      position: relative; /* Untuk posisi tombol logout */
    }
    
    /* Tombol Logout */
    .logout-btn {
        position: absolute;
        top: 20px;
        right: 20px;
        background: white;
        color: black;
        padding: 8px 15px;
        border: 1px solid #ccc;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: 0.3s;
        width: auto; /* Override button width: 95% */
        margin-top: 0;
    }
    .logout-btn:hover {
        background: #e2e8f0;
        color: #333;
    }

    .container-dashboard { padding: 20px; }
    .menu { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 20px; margin-top: 30px; }
    /* Hanya tampilkan menu yang tersisa */
    .menu button {
      background: white; border: 2px solid #007bff; border-radius: 15px; padding: 20px; font-size: 16px; font-weight: 600;
      cursor: pointer; transition: 0.3s; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      /* Batasi lebar tombol menu yang tersisa */
      min-width: 200px; 
    }
    .menu button:hover { background: #007bff; color: white; transform: scale(1.05); }

    footer { text-align: center; margin-top: 40px; color: #777; font-size: 14px; }

    /* === KATALOG & LAPORAN === */
    #katalogSection, #aboutSection { display: none; margin-top: 30px; }
    table { width: 100%; border-collapse: collapse; background: white; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; vertical-align: middle; }
    th { background-color: #007bff; color: white; }
    
    /* STYLE UNTUK FOTO AGAR TERLIHAT SEMUANYA */
    td img { 
      max-height: 100px; 
      max-width: 100%; /* Agar gambar menyesuaikan lebar kolom */
      object-fit: contain; /* Memastikan gambar terlihat seluruhnya */
      display: block; 
      margin: 0 auto; 
    }
    /* Akhir STYLE FOTO */

    .table-responsive { overflow-x: auto; }

    .form-tambah { background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .form-tambah input { width: 100%; margin: 5px 0; padding: 8px; }

    /* === TOMBOL KHUSUS KATALOG === */
    .small-btn { padding:8px 12px; border-radius:6px; border:none; cursor:pointer; background:#4c51bf; color:white; }
    .small-btn.delete-btn { background:#ef4444; color:white; padding: 6px 10px; font-size: 13px; margin-top: 4px; } 
    .small-btn.edit-btn { background:#f59e0b; color:white; padding: 6px 10px; font-size: 13px; margin-right: 5px;}
    .small-btn.delete-btn:hover { background: #dc2626; }
    .small-btn.edit-btn:hover { background: #d97706; }
    .small-btn:hover { background:#434190; }
    
    /* === STYLE KHUSUS ABOUT SECTION (MODIFIED) === */
    .card-gallery {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    .card-item {
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        padding: 15px;
        text-align: center;
        /* Tambahan untuk hover */
        cursor: pointer;
        transition: 0.3s;
        border: 2px solid transparent; /* Border default */
    }
    /* EFEK HOVER BARU */
    .card-item:hover {
        background: #007bff; /* Background biru seperti menu dashboard */
        color: white; /* Warna teks utama menjadi putih */
        transform: scale(1.05); /* Membesar sedikit */
        border-color: #007bff; /* Border menjadi biru */
        box-shadow: 0 6px 15px rgba(0, 123, 255, 0.4); /* Tambahkan shadow biru */
    }
    .card-item img {
        width: 100%;
        height: 150px;
        object-fit: contain; /* Ganti cover ke contain agar mobil terlihat jelas */
        border-radius: 8px;
        margin-bottom: 10px;
        transition: 0.3s;
    }
    .card-item p {
        font-size: 14px;
        color: #555;
        margin: 5px 0 0;
        font-weight: 600;
        min-height: 40px; 
        display: flex;
        align-items: center;
        justify-content: center;
    }
    /* EFEK HOVER: Warna teks di dalam card (Nama Mobil & Harga) */
    .card-item:hover p,
    .card-item:hover span {
        color: white !important; /* Paksa warna teks menjadi putih saat hover */
    }


    /* responsive */
    @media (max-width:600px){
      .modal-content { width: 92%; }
      .container { width: 92%; }
      td img { max-height:70px; }
      .table-responsive table { font-size: 12px; }
      .table-responsive th, .table-responsive td { padding: 6px; }
      .logout-btn { top: 10px; right: 10px; padding: 6px 10px; font-size: 12px; }
      .card-gallery { grid-template-columns: 1fr; }
      .menu { grid-template-columns: 1fr; }
      .menu button { min-width: unset; }
    }
  </style>
</head>
<body>

  <div class="login-page" id="loginPage">
    <div class="container">
      <img src="Toko Sorum Mobil Online.jpg" alt="Logo Toko Sorum Mobil Online">
      <h2>Login Pemesanan Mobil</h2>

      <input type="email" id="email" placeholder="Email"><br>
      <input type="password" id="password" placeholder="Password"><br>
      <button onclick="login()">Login</button>

      <div class="links">
        <a onclick="openModal('forgotModal')">Lupa Password</a>
        <a onclick="openModal('registerModal')">Daftar</a>
      </div>

      <div class="footer-text">
        Baca <a onclick="openModal('syaratKetentuanModal')">Syarat & Ketentuan</a> atau <a onclick="openModal('kebijakanPrivasiModal')">Kebijakan Privasi</a>
      </div>
    </div>
  </div>

  <div id="forgotModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('forgotModal')">&times;</span>
      <h3>Lupa Password</h3>
      <p>Masukkan email Anda untuk reset password:</p>
      <input type="email" placeholder="Email"><br><br>
      <button class="btn-primary">Kirim</button>
    </div>
  </div>

  <div id="registerModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('registerModal')">&times;</span>
      <h3>Lengkapi Identitas Anda</h3>
      <p>Silahkan lengkapi data diri Anda.</p>
      <input type="email" placeholder="Email Anda">
      <input type="text" placeholder="Nama Lengkap">
      <input type="text" placeholder="Nomor Ponsel">
      <input type="text" placeholder="Alamat Sesuai Identitas">
      <select>
        <option value="">Kecamatan</option>
        <option value="Gambir">Gambir</option>
        <option value="Menteng">Menteng</option>
        <option value="Tebet">Tebet</option>
      </select>
      <input type="password" placeholder="Kata Sandi">
      <input type="password" placeholder="Konfirmasi Kata Sandi">

      <p class="footer-text">
        Dengan mendaftar, saya menyetujui <a onclick="openModal('syaratKetentuanModal')">Syarat & Ketentuan</a> serta <a onclick="openModal('kebijakanPrivasiModal')">Kebijakan Privasi</a>
      </p>

      <div style="display:flex; justify-content:space-around; margin-top:15px;">
        <button class="btn-secondary" onclick="closeModal('registerModal')">Sebelumnya</button>
        <button class="btn-primary">Selanjutnya</button>
      </div>
    </div>
  </div>

  <div id="syaratKetentuanModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('syaratKetentuanModal')">&times;</span>
      <h3>Syarat & Ketentuan Toko Sorum Mobil Online</h3>
      <p>Konten Syarat & Ketentuan</p>
    </div>
  </div>

  <div id="kebijakanPrivasiModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('kebijakanPrivasiModal')">&times;</span>
      <h3>Kebijakan Privasi Toko Sorum Mobil Online</h3>
      <p>Konten Kebijakan Privasi</p>
    </div>
  </div>

  <div class="dashboard-page" id="dashboardPage">
    <header>
      <h1 id="greeting">Selamat Datang!</h1>
      <p>Toko Sorum Mobil Online</p>
      <button class="logout-btn" onclick="logout()">Logout</button> </header>

    <div class="container-dashboard">
      <h2>Dashboard Menu</h2>
      <div class="menu">
        <button onclick="tampilkanAbout()">ðŸ’¡ Tentang Kami dan Pemesanan Online</button> 
        <button onclick="tampilkanKatalog()">ðŸ“š Informasi Katalog</button>
        </div>
      
      <div id="aboutSection">
        <h2 style="margin-bottom: 20px;">Tentang Kami & Pemesanan Online</h2>
        
        <div style="background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
            <p style="font-size: 16px; line-height: 1.6;">
                Memesan sorum mobil online adalah proses yang praktis dan mudah. Mulainya dengan menelusuri galeri digital kami dikatalog sorum mobil di platform web ini dengan memilih model, warna, dan ukuran yang diinginkan. Setelah menemukan item yang disukai. Anda dapat melanjutkan ke proses pemesanan.
            </p>
        </div>
        
        <h3 style="margin-top: 30px; border-bottom: 2px solid #007bff; padding-bottom: 10px;">Katalog Mobil Pilihan Kami</h3>
        
        <div class="card-gallery" id="sweaterGallery">
            </div>
      </div>
      
      <div id="katalogSection">
        <h2>ðŸ“š Informasi Stok / Katalog Mobil</h2>
        <div class="table-responsive">
          <table id="tabelKatalog">
            <thead>
              <tr>
                <th>Kode</th>
                <th>Tipe</th> <th>Nama Mobil</th>
                <th>Jenis</th>
                <th>Edisi</th>
                <th>Stok</th>
                <th>Harga</th>
                <th>Foto</th>
                <th>Aksi</th> 
                </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="form-tambah">
          <h3>Tambah Mobil Baru</h3>
          <input type="text" id="kodeBarang" placeholder="Kode Barang">
          <select id="ukuranInput"> <option value="">Pilih Tipe</option>
            <option value="Standard">Standard</option>
            <option value="GX">GX</option>
            <option value="GL">GL</option>
            <option value="Hybrid">Hybrid</option>
            <option value="Alpha">Alpha</option>
            <option value="GLX">GLX</option>
          </select> 
          <input type="text" id="namaBarang" placeholder="Nama Mobil">
          <input type="text" id="jenisBarang" placeholder="Jenis Mobil">
          <input type="text" id="edisi" placeholder="Tahun Edisi">
          <input type="number" id="stok" placeholder="Jumlah Stok">
          <input type="text" id="harga" placeholder="Harga (contoh: Rp 298.800.000)">
          <input type="text" id="pathFoto" placeholder="(Opsional) Nama file atau URL, contoh: Ertiga.jpg">
          <label style="font-size:13px;color:#555;margin-top:6px;display:block;">Atau upload file foto:</label>
          <input type="file" id="fotoUpload" accept="image/*">
          <div style="display:flex; gap:8px; margin-top:8px;">
            <button onclick="tambahBuku()" class="small-btn" style="width:100%;">Tambah Mobil</button>
            </div>
          <div id="previewFoto" style="margin-top:8px; font-size:13px; color:#333;"></div>
        </div>
      </div>
      
      <div id="trackingSection" style="display:none;"></div>
      <div id="laporanPemesananSection" style="display:none;"></div>
      <div id="historyTransaksiSection" style="display:none;"></div>
      
    </div>
    
    <div id="editModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal('editModal')">&times;</span>
        <h3>Edit Data Mobil</h3>
        <div class="form-tambah">
            <label for="editKodeBarang" style="display:block; margin-top:10px;">Kode Barang (Tidak dapat diubah):</label>
            <input type="text" id="editKodeBarang" readonly style="background:#eee;">
            
            <label for="editUkuranInput" style="display:block; margin-top:10px;">Tipe/Varian:</label>
            <select id="editUkuranInput"> 
              <option value="Standard">Standard</option>
              <option value="GX">GX</option>
              <option value="GL">GL</option>
              <option value="Hybrid">Hybrid</option>
              <option value="Alpha">Alpha</option>
              <option value="GLX">GLX</option>
            </select> 
            
            <label for="editNamaBarang" style="display:block; margin-top:10px;">Nama Mobil:</label>
            <input type="text" id="editNamaBarang">
            
            <label for="editJenisBarang" style="display:block; margin-top:10px;">Jenis Mobil:</label>
            <input type="text" id="editJenisBarang">
            
            <label for="editEdisi" style="display:block; margin-top:10px;">Tahun Edisi:</label>
            <input type="text" id="editEdisi">
            
            <label for="editStok" style="display:block; margin-top:10px;">Jumlah Stok:</label>
            <input type="number" id="editStok">
            
            <label for="editHarga" style="display:block; margin-top:10px;">Harga:</label>
            <input type="text" id="editHarga" placeholder="Rp XXX.XXX.XXX">
            
            <label for="editPathFoto" style="display:block; margin-top:10px;">URL/Nama File Foto:</label>
            <input type="text" id="editPathFoto" placeholder="(Opsional)">
            
            <div style="display:flex; justify-content:space-around; gap:8px; margin-top:20px;">
                <button class="btn-secondary" onclick="closeModal('editModal')" style="width:50%;">Batal</button>
                <button class="btn-primary" onclick="saveEditBuku()" style="width:50%;">Simpan Perubahan</button>
            </div>
        </div>
      </div>
    </div>
    <footer>
      Â© 2025 Toko Sorum Mobil Online. Semua Hak Dilindungi.
    </footer>
  </div>

<script>
    /* === === DATA MODELLING (DIUBAH) === === */
    function uid() { return 'id-' + Math.random().toString(36).slice(2, 9); }

    var dataPengguna = [
      { id: 1, nama: "Rina Wulandari", email: "rina@gmail.com", password: "rina123", role: "User" },
      { id: 2, nama: "Agus Pranoto", email: "agus@gmail.com", password: "agus123", role: "User" },
      // ADMIN ACCOUNT - PASTIKAN EMAIL DAN PASSWORD SAMA PERSIS DENGAN INPUT
      { id: 3, nama: "Siti Marlina", email: "siti@gmail.com", password: "siti123", role: "Admin" }
    ];
    
    // Key untuk persistensi status login
    const LOGIN_STATUS_KEY = "tokoBuku_loginStatus";
    const LOGGED_IN_USER_KEY = "tokoBuku_loggedInUser";

    const KATALOG_LS_KEY = "tokoBuku_dataKatalog_v3_mobil"; // Updated version key
    const DEFAULT_KATALOG = [
      // DATA MOBIL
      { kodeBarang: "ERT001", namaBarang: "All New Ertiga", jenisBarang: "MPV", edisi: "2025", stok: 10, harga: "Rp 298.800.000", hargaNumerik: 298800000, pathFoto: "Ertiga.png", ukuran: "Hybrid" },
      { kodeBarang: "XL701", namaBarang: "XL 7 Hybrid", jenisBarang: "MPV", edisi: "2025", stok: 8, harga: "Rp 312.000.000", hargaNumerik: 312000000, pathFoto: "Xl 7.png", ukuran: "Alpha" },
      { kodeBarang: "IGN001", namaBarang: "Ignis", jenisBarang: "City Car", edisi: "2025", stok: 15, harga: "Rp 118.000.000", hargaNumerik: 118000000, pathFoto: "Ignis.png", ukuran: "GX" },
      { kodeBarang: "VTR001", namaBarang: "Grand Vitara", jenisBarang: "SUV", edisi: "2025", stok: 5, harga: "Rp 400.000.000", hargaNumerik: 400000000, pathFoto: "GrandVitara.png", ukuran: "GLX" },
      { kodeBarang: "CAR001", namaBarang: "Carry", jenisBarang: "Niaga", edisi: "2025", stok: 20, harga: "Rp 195.000.000", hargaNumerik: 195000000, pathFoto: "Carry.png", ukuran: "Standard" }
    ];
    let dataKatalogBuku = JSON.parse(localStorage.getItem(KATALOG_LS_KEY) || "null");
    if (!Array.isArray(dataKatalogBuku) || dataKatalogBuku.length === 0 || !dataKatalogBuku.every(b => 'ukuran' in b)) {
      dataKatalogBuku = DEFAULT_KATALOG;
      localStorage.removeItem(KATALOG_LS_KEY);
    } 
    saveKatalogLS(); 

    // HAPUS DATA MODELLING TRACKING DAN PEMESANAN

    /* === HELPER FUNCTIONS (LOOKUP) === */
    function getBukuByKode(kode) { return dataKatalogBuku.find(b => b.kodeBarang === kode); }
    // HAPUS FUNGSI LOOKUP TRACKING/PEMESANAN
    function formatRupiah(angka) { 
        if (isNaN(angka)) return '-'; 
        var reverse = angka.toString().split('').reverse().join(''), 
        ribuan = reverse.match(/\d{1,3}/g); 
        ribuan = ribuan.join('.').split('').reverse().join(''); 
        return 'Rp ' + ribuan; 
    }
    function parseRupiah(rupiah) { return parseInt(rupiah.replace(/[^0-9]/g, '')) || 0; }
    function escapeHtml(text) { if (text === null || text === undefined) return ""; return String(text).replace(/[&<>"']/g, function (m) { return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]; }); }
    // HAPUS FUNGSI getTodayDate
    

    /* === UTILITY === */
    function hideAllSections() {
      document.getElementById("aboutSection").style.display = "none";
      document.getElementById("katalogSection").style.display = "none";
      // HAPUS ID SECTION YANG TIDAK RELEVAN
    }
    function showNotification(message) {
        alert(message);
    }
    function getCurrentTimeGreeting() {
      const hour = new Date().getHours();
      if (hour < 12) return "Selamat Pagi!";
      if (hour < 17) return "Selamat Siang!";
      if (hour < 20) return "Selamat Sore!";
      return "Selamat Malam!";
    }

    /* === LOCAL STORAGE HANDLERS === */
    function saveKatalogLS() { localStorage.setItem(KATALOG_LS_KEY, JSON.stringify(dataKatalogBuku)); }
    // HAPUS SAVE TRACKING DAN PEMESANAN

    /* === LOGIN / LOGOUT / DASHBOARD === */
    function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const user = dataPengguna.find(u => u.email === email && u.password === password);

      if (user) {
        localStorage.setItem(LOGIN_STATUS_KEY, "true");
        localStorage.setItem(LOGGED_IN_USER_KEY, user.nama);
        localStorage.setItem("userRole", user.role); 
        showDashboard();
      } else {
        alert("Login Gagal! Email atau password salah.");
      }
    }
    
    function logout() {
      if (confirm("Apakah Anda yakin ingin Logout?")) {
        localStorage.removeItem(LOGIN_STATUS_KEY);
        localStorage.removeItem(LOGGED_IN_USER_KEY);
        localStorage.removeItem("userRole");
        document.getElementById("dashboardPage").style.display = "none";
        document.getElementById("loginPage").style.display = "flex";
        alert("Anda telah Logout.");
      }
    }

    function showDashboard() {
      const greetingText = getCurrentTimeGreeting(); 
      document.getElementById("greeting").textContent = greetingText; 
      document.getElementById("loginPage").style.display = "none";
      document.getElementById("dashboardPage").style.display = "block";
      // Memastikan tabel ter-render setelah login/refresh
      renderTabelKatalog(); 
      renderSweaterGallery(); 
    } 

    /* === MODAL UTIL === */
    function openModal(id) { document.getElementById(id).style.display = "block"; }
    function closeModal(id) { document.getElementById(id).style.display = "none"; }
    window.onclick = function(event) {
      const modals = document.getElementsByClassName("modal");
      for (let modal of modals) {
        if (event.target == modal) modal.style.display = "none";
      }
    }

    /* === ABOUT SECTION === */
    function tampilkanAbout() {
      hideAllSections();
      document.getElementById("aboutSection").style.display = "block";
      renderSweaterGallery();
    }
    
    function renderSweaterGallery() {
      const gallery = document.getElementById("sweaterGallery");
      gallery.innerHTML = "";
      DEFAULT_KATALOG.forEach(item => {
        const card = document.createElement("div");
        card.className = "card-item";
        const img = document.createElement("img");
        img.src = item.pathFoto;
        img.alt = item.namaBarang;
        img.onerror = function(){ 
            this.onerror = null; 
            // Placeholder SVG for missing images
            this.src = 'data:image/svg+xml;utf8,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24"><path fill="#ccc" d="M8.5 13.5l2.5 3.15L14 12l4 5H6zm6.5-7.5H5c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2z"/></svg>'); 
        };
        const p = document.createElement("p");
        p.textContent = item.namaBarang;
        const price = document.createElement("span");
        price.style.display = "block";
        price.style.marginTop = "5px";
        price.style.fontSize = "14px";
        price.style.fontWeight = "bold";
        price.style.color = "#007bff";
        price.textContent = formatRupiah(item.hargaNumerik);

        card.appendChild(img);
        card.appendChild(p);
        card.appendChild(price);
        gallery.appendChild(card);
      });
    }

    /* === KATALOG (FUNGSI DI MODIFIKASI) === */
    function tampilkanKatalog() {
      hideAllSections();
      document.getElementById("katalogSection").style.display = "block";
      renderTabelKatalog();
    }
    
    // Placeholder SVG untuk gambar yang tidak ditemukan
    const PLACEHOLDER_SVG = 'data:image/svg+xml;utf8,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24"><path fill="#ccc" d="M8.5 13.5l2.5 3.15L14 12l4 5H6zm6.5-7.5H5c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2z"/></svg>'); 

    function renderTabelKatalog() {
      const tbody = document.querySelector("#tabelKatalog tbody");
      tbody.innerHTML = "";
      if (dataKatalogBuku.length === 0) {
        tbody.innerHTML = `<tr><td colspan="9">Tidak ada data mobil dalam katalog.</td></tr>`;
        return;
      }
      dataKatalogBuku.forEach(buku => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${buku.kodeBarang}</td>
          <td>${buku.ukuran}</td> <td style="text-align:left;">${buku.namaBarang}</td>
          <td>${buku.jenisBarang}</td>
          <td>${buku.edisi}</td>
          <td>${buku.stok}</td>
          <td style="font-weight:600;">${buku.harga}</td>
          <td><img src="${buku.pathFoto}" alt="${buku.namaBarang}" onerror="this.onerror=null;this.src='${PLACEHOLDER_SVG}';"></td>
          <td>
            <button class="small-btn edit-btn" onclick="openEditModal('${buku.kodeBarang}')">Edit</button>
            <button class="small-btn delete-btn" onclick="deleteBuku('${buku.kodeBarang}')">Delete</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    // IMPLEMENTASI FUNGSI TAMBAH BUKU (DIUBAH UNTUK MOBIL)
    function tambahBuku() {
      const kodeBarang = document.getElementById("kodeBarang").value.trim().toUpperCase();
      const ukuran = document.getElementById("ukuranInput").value; // Digunakan sebagai Tipe/Varian
      const namaBarang = document.getElementById("namaBarang").value.trim();
      const jenisBarang = document.getElementById("jenisBarang").value.trim();
      const edisi = document.getElementById("edisi").value.trim();
      const stok = parseInt(document.getElementById("stok").value.trim());
      const hargaInput = document.getElementById("harga").value.trim();
      let pathFoto = document.getElementById("pathFoto").value.trim();
      const fotoUpload = document.getElementById("fotoUpload").files[0];

      if (!kodeBarang || !namaBarang || isNaN(stok) || stok < 0 || !hargaInput || !ukuran) {
        showNotification("Kode Barang, Nama Mobil, Stok, Harga, dan Tipe wajib diisi dengan benar!");
        return;
      }
      if (dataKatalogBuku.some(b => b.kodeBarang === kodeBarang)) {
        showNotification(`Kode Barang ${kodeBarang} sudah ada. Gunakan kode lain atau edit data yang sudah ada.`);
        return;
      }
      
      const hargaNumerik = parseRupiah(hargaInput);
      const hargaFormatted = formatRupiah(hargaNumerik);

      // Simulasi penyimpanan file (Hanya mengambil nama file/URL)
      if (fotoUpload) {
        pathFoto = fotoUpload.name;
      } else if (!pathFoto) {
        pathFoto = null; // Tidak ada foto
      }

      const newBuku = { 
        kodeBarang: kodeBarang, 
        namaBarang: namaBarang, 
        jenisBarang: jenisBarang, 
        edisi: edisi, 
        stok: stok, 
        harga: hargaFormatted, 
        hargaNumerik: hargaNumerik, 
        pathFoto: pathFoto, 
        ukuran: ukuran // Simpan Tipe/Varian di field 'ukuran'
      };

      dataKatalogBuku.push(newBuku);
      saveKatalogLS();
      renderTabelKatalog();
      renderSweaterGallery(); // Perbarui juga galeri di About Section

      // Bersihkan form
      document.getElementById("kodeBarang").value = "";
      document.getElementById("ukuranInput").value = ""; 
      document.getElementById("namaBarang").value = "";
      document.getElementById("jenisBarang").value = "";
      document.getElementById("edisi").value = "";
      document.getElementById("stok").value = "";
      document.getElementById("harga").value = "";
      document.getElementById("pathFoto").value = "";
      document.getElementById("fotoUpload").value = "";
      showNotification(`Mobil "${namaBarang}" berhasil ditambahkan ke katalog.`);
    }

    function deleteBuku(kode) {
      if (confirm(`Apakah Anda yakin ingin menghapus mobil dengan kode ${kode} dari katalog?`)) {
        const initialLength = dataKatalogBuku.length;
        dataKatalogBuku = dataKatalogBuku.filter(b => b.kodeBarang !== kode);
        if (dataKatalogBuku.length < initialLength) {
          saveKatalogLS();
          renderTabelKatalog();
          renderSweaterGallery();
          showNotification("Data mobil berhasil dihapus.");
        } else {
          showNotification("Gagal menghapus data mobil.");
        }
      }
    }
    
    let currentEditKode = null;

    // FUNGSI EDIT BARU
    function openEditModal(kode) {
        const buku = getBukuByKode(kode);
        if (!buku) {
            showNotification("Data mobil tidak ditemukan.");
            return;
        }

        currentEditKode = kode;
        document.getElementById('editKodeBarang').value = buku.kodeBarang;
        document.getElementById('editUkuranInput').value = buku.ukuran;
        document.getElementById('editNamaBarang').value = buku.namaBarang;
        document.getElementById('editJenisBarang').value = buku.jenisBarang;
        document.getElementById('editEdisi').value = buku.edisi;
        document.getElementById('editStok').value = buku.stok;
        document.getElementById('editHarga').value = buku.harga;
        document.getElementById('editPathFoto').value = buku.pathFoto || '';

        openModal('editModal');
    }

    function saveEditBuku() {
        const kode = currentEditKode;
        const index = dataKatalogBuku.findIndex(b => b.kodeBarang === kode);

        if (index === -1) {
            showNotification("Gagal menyimpan. Data mobil tidak ditemukan.");
            return;
        }

        const ukuran = document.getElementById('editUkuranInput').value;
        const namaBarang = document.getElementById('editNamaBarang').value.trim();
        const jenisBarang = document.getElementById('editJenisBarang').value.trim();
        const edisi = document.getElementById('editEdisi').value.trim();
        const stok = parseInt(document.getElementById('editStok').value.trim());
        const hargaInput = document.getElementById('editHarga').value.trim();
        const pathFoto = document.getElementById('editPathFoto').value.trim();

        if (!namaBarang || isNaN(stok) || stok < 0 || !hargaInput || !ukuran) {
            showNotification("Nama Mobil, Stok, Harga, dan Tipe wajib diisi dengan benar!");
            return;
        }

        const hargaNumerik = parseRupiah(hargaInput);
        const hargaFormatted = formatRupiah(hargaNumerik);
        
        // Update data
        dataKatalogBuku[index].ukuran = ukuran;
        dataKatalogBuku[index].namaBarang = namaBarang;
        dataKatalogBuku[index].jenisBarang = jenisBarang;
        dataKatalogBuku[index].edisi = edisi;
        dataKatalogBuku[index].stok = stok;
        dataKatalogBuku[index].harga = hargaFormatted;
        dataKatalogBuku[index].hargaNumerik = hargaNumerik;
        dataKatalogBuku[index].pathFoto = pathFoto || null;

        saveKatalogLS();
        renderTabelKatalog();
        renderSweaterGallery();
        closeModal('editModal');
        showNotification(`Data mobil "${namaBarang}" berhasil diperbarui.`);
    }
    
    // HAPUS SEMUA FUNGSI TRACKING, LAPORAN PEMESANAN, DAN HISTORY TRANSAKSI

    /* === Inisialisasi tampilan awal (MODIFIKASI) === */
    document.addEventListener("DOMContentLoaded", function(){
      // Cek status login di localStorage
      if (localStorage.getItem(LOGIN_STATUS_KEY) === "true") {
        showDashboard(); // Tampilkan dashboard jika sudah login
        tampilkanAbout(); // Tampilkan About Section sebagai default setelah login/refresh
      } else {
        document.getElementById("loginPage").style.display = "flex";
      }
    });
</script>
</body>
</html>